Version 4
SHEET 1 2876 2360
WIRE -192 80 -288 80
WIRE -16 80 -192 80
WIRE 32 80 -16 80
WIRE 128 80 112 80
WIRE 256 80 128 80
WIRE 304 80 256 80
WIRE 560 80 400 80
WIRE 720 80 560 80
WIRE 832 80 720 80
WIRE 832 96 832 80
WIRE -288 112 -288 80
WIRE -16 128 -16 80
WIRE 48 128 -16 128
WIRE 128 128 128 80
WIRE 128 128 80 128
WIRE 48 144 48 128
WIRE 80 144 80 128
WIRE 320 144 320 128
WIRE 832 192 832 160
WIRE -288 208 -288 192
WIRE -16 256 -16 128
WIRE 32 256 32 240
WIRE 32 256 -16 256
WIRE 64 272 64 240
WIRE 224 272 208 272
WIRE 400 272 224 272
WIRE 560 272 560 80
WIRE 560 272 496 272
WIRE 96 336 96 240
WIRE 416 336 416 320
WIRE 208 352 208 272
WIRE 96 368 96 336
WIRE 208 448 208 432
WIRE 96 464 96 448
WIRE 448 544 368 544
WIRE 608 544 512 544
WIRE 1360 560 1280 560
WIRE 1520 560 1424 560
WIRE -96 656 -160 656
WIRE -32 656 -96 656
WIRE 368 672 368 544
WIRE 432 672 368 672
WIRE 608 672 608 544
WIRE 608 672 512 672
WIRE 1280 672 1280 560
WIRE 1344 672 1280 672
WIRE 1520 672 1520 560
WIRE 1520 672 1424 672
WIRE -384 688 -384 656
WIRE -160 736 -160 656
WIRE -144 736 -160 736
WIRE -32 752 -32 656
WIRE -32 752 -80 752
WIRE -144 768 -176 768
WIRE -384 784 -384 768
WIRE -384 784 -400 784
WIRE -384 800 -384 784
WIRE -112 800 -112 784
WIRE 464 816 464 784
WIRE 464 816 448 816
WIRE 1376 816 1376 784
WIRE 1376 816 1360 816
WIRE 240 832 192 832
WIRE 368 832 368 672
WIRE 368 832 320 832
WIRE 1152 832 1104 832
WIRE 1280 832 1280 672
WIRE 1280 832 1232 832
WIRE 368 880 368 832
WIRE 416 880 368 880
WIRE 1280 880 1280 832
WIRE 1328 880 1280 880
WIRE -384 896 -384 880
WIRE 608 896 608 672
WIRE 608 896 576 896
WIRE 736 896 608 896
WIRE 1520 896 1520 672
WIRE 1520 896 1488 896
WIRE 1568 896 1520 896
WIRE 416 912 368 912
WIRE 1328 912 1280 912
WIRE -208 944 -240 944
WIRE 96 944 -208 944
WIRE 304 944 176 944
WIRE 368 944 368 912
WIRE 368 944 304 944
WIRE 944 944 896 944
WIRE 1280 944 1280 912
WIRE 1280 944 1024 944
WIRE -240 960 -240 944
WIRE 368 976 368 944
WIRE 464 976 448 976
WIRE 1280 976 1280 944
WIRE 1376 976 1360 976
WIRE -240 1056 -240 1040
WIRE 1280 1088 1280 1056
WIRE 1376 1088 1376 976
WIRE 1376 1088 1280 1088
WIRE 368 1104 368 1056
WIRE 464 1104 464 976
WIRE 464 1104 368 1104
WIRE 464 1152 464 1104
WIRE 1376 1152 1376 1088
FLAG -288 208 0
FLAG 208 448 0
FLAG 832 192 0
FLAG 96 464 0
FLAG 64 272 0
FLAG 96 336 CURR
FLAG -192 80 IN
FLAG 256 80 SPLIT
FLAG 320 144 GATE
FLAG 224 272 CAP
FLAG -384 656 VCC
FLAG 416 336 GATEC
FLAG -384 896 VEE
FLAG -400 784 0
FLAG -240 1056 0
FLAG -208 944 CURR_LIMIT
FLAG -176 768 CURR
FLAG -112 720 VCC
FLAG -112 800 0
FLAG -96 656 CURR_B
FLAG 192 832 CURR_B
FLAG 1568 896 GATEC
FLAG 736 896 GATE
FLAG 464 1152 VEE
FLAG 896 944 CURR_B
FLAG 1376 1152 VEE
FLAG 1104 832 CURR_LIMIT
FLAG 368 544 +
FLAG 304 944 -
FLAG 464 784 VCC
FLAG 1376 784 VCC
FLAG 720 80 OUT
SYMBOL voltage -288 96 R0
WINDOW 123 24 124 Left 2
WINDOW 39 24 124 Left 2
SYMATTR Value2 AC 1
SYMATTR InstName V1
SYMATTR Value 24
SYMBOL voltage 208 336 R0
WINDOW 123 0 0 Left 0
WINDOW 39 24 124 Left 2
SYMATTR InstName V2
SYMATTR Value 24
SYMBOL res 80 352 R0
SYMATTR InstName R2
SYMATTR Value 100k
SYMATTR SpiceLine tol=5
SYMBOL INA138 64 192 M90
SYMATTR InstName U1
SYMBOL res 128 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 20m
SYMBOL voltage -384 672 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value {VCC}
SYMBOL voltage -384 784 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value 0
SYMBOL voltage -240 944 M0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 1
SYMBOL OpAmps\\UniversalOpAmp2 -112 752 R0
SYMATTR InstName U5
SYMBOL load 816 96 R0
WINDOW 123 48 84 Left 2
WINDOW 39 0 0 Left 0
SYMATTR Value2 AC 1
SYMATTR InstName I1
SYMATTR Value PULSE(1 {Imax} {simtime/2} 10u 10u {simtime/10} {simtime/5} 1)
SYMBOL res 336 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value {R}
SYMBOL res 528 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value {A*R}
SYMBOL res 1040 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R8
SYMATTR Value {R}
SYMBOL res 1248 816 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value {R}
SYMBOL res 1296 960 M0
SYMATTR InstName R11
SYMATTR Value {A*R}
SYMBOL cap 512 528 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C3
SYMATTR Value {1/(A*R*wc)}
SYMBOL res 192 928 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value {R}
SYMBOL res 384 960 M0
SYMATTR InstName R13
SYMATTR Value {A*R}
SYMBOL res 1440 656 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value {A*R}
SYMBOL cap 1424 544 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C1
SYMATTR Value {1/(A*R*wc)}
SYMBOL OPA551 496 896 R0
SYMATTR InstName U2
SYMBOL OPA551 1408 896 R0
SYMATTR InstName U3
SYMBOL nmos 400 128 M270
SYMATTR InstName M1
SYMATTR Value BSC015NE2LS5I
SYMBOL nmos 496 320 M270
SYMATTR InstName M2
SYMATTR Value BSC015NE2LS5I
TEXT -488 400 Left 2 ;.op
TEXT -488 432 Left 2 !.tran 0 {simtime} {simtime/10}
TEXT -488 464 Left 2 ;.ac dec 20 0.01 10G
TEXT -232 568 Left 2 !.param simtime=10m
TEXT 752 432 Left 2 !.step dec param Imax 1 10 20
TEXT 760 464 Left 2 !.param Imax=10
TEXT -232 536 Left 2 !;.step dec param simtime 100m 10m 7
TEXT 480 1424 Left 2 !.param A=10000 wc=2.5k R=1k
TEXT 520 1472 Left 2 !;.step dec param A 1k 10k 4
TEXT 480 1392 Left 2 !;.param A=10 wc=1 R=1k
TEXT -616 992 Left 2 !;.step param VCC 30 40 2
TEXT -568 1024 Left 2 !.param VCC=30
